import Foundation

let nomJourRevolutionnaireMois1: [String] = ["jour du Ravin", "jour du Safran", "jour de la Châtaigne", "jour de la Colchique", "jour du Cheval", "jour de la Balsamine", "jour de la Carotte", "jour de l'Amaranthe", "jour du Panais", "jour de la Cuve", "jour de la Pomme de terre", "jour de l'Immortelle", "jour du Potiron", "jour du Réséda", "jour de l'Ane", "jour de la Belle de nuit", "jour de la Citrouille", "jour du Sarrasin", "jour du Tournesol", "jour du Pressoir", "jour du Chanvre", "jour de la Péche", "jour du Navet", "jour de l'Amarillis", "jour du Boeuf", "jour de l'Aubergine", "jour du Piment", "jour de la Tomate", "jour de l'Orge", "jour du Tonneau"]
let nomJourRevolutionnaireMois2: [String] = ["jour de la Pomme", "jour du Céleri", "jour de la Poire", "jour de la Betterave", "jour de l'Oie", "jour de l'Héliotrope", "jour de la Figue", "jour de la Scorsonère", "jour de l'Alisier", "jour de la Charrue", "jour du Salsifis", "jour Macre", "jour du Topinambour", "jour de l'Endive", "jour du Dindon", "jour Chervis", "jour du Cresson", "jour de la Dentelaire", "jour de la Grenade", "jour de la Herse", "jour de la Bacchante", "jour de l'Azerole", "jour de la Garance", "jour de l'Orange", "jour du Faisan", "jour de la Pistache", "jour du Macjonc", "jour du Coing", "jour du Cormier", "jour du Rouleau"]
let nomJourRevolutionnaireMois3: [String] = ["jour de la Raiponce", "jour du Turneps", "jour de la Chicorée", "jour de la Nèfle", "jour du Cochon", "jour de la Mâche", "jour du Chou-fleur", "jour du Miel", "jour du Genièvre", "jour de la Pioche", "jour de la Cire", "jour du Raifort", "jour du Cèdre", "jour du Sapin", "jour du Chevreuil", "jour de l'Ajonc", "jour du Cyprés", "jour du Lierre", "jour de la Sabine", "jour du Hoyau", "jour de l'Érable-sucre", "jour de la Bruyère", "jour du Roseau", "jour de l'Oseille", "jour du Grillon", "jour du Pignon", "jour du Liège", "jour de la Truffe", "jour de l'Olive", "jour de la Pelle"]

let nomJourRevolutionnaireMois4: [String] = ["jour de la Tourbe", "jour de la Houille", "jour du Bitume", "jour du Soufre", "jour du Chien", "jour de la Lave", "jour de la Terre végétale", "jour du Fumier", "jour du Salpêtre", "jour du Fléau", "jour du Granit", "jour de l'Argile", "jour de l'Ardoise", "jour du Grès", "jour du Lapin", "jour du Silex", "jour de la Marne", "jour de la Pierre à chaux", "jour du Marbre", "jour du Van", "jour de la Pierre à plâtre", "jour du Sel", "jour du Fer", "jour du Cuivre", "jour du Chat", "jour de l'Etain", "jour du Plomb", "jour du Zinc", "jour du Mercure", "jour du Crible"]
let nomJourRevolutionnaireMois5: [String] = ["jour de la Lauréole", "jour de la Mousse", "jour du Fragon", "jour de la PerceNeige", "jour du Taureau", "jour du Laurier-thym", "jour de l'Amadouvier", "jour du Mézéréon", "jour du Peuplier", "jour de la Coignée", "jour de l'Ellébore", "jour du Brocoli", "jour du Laurier", "jour de l'Avelinier", "jour de la Vache", "jour du Buis", "jour du Lichen", "jour de l'If", "jour de la Pulmonaire", "jour de la Serpette", "jour du Thlaspi", "jour du Thimèle", "jour du Chiendent", "jour de la Trainasse", "jour du Lièvre", "jour de la Guède", "jour du Noisetier", "jour du Cyclamen", "jour de la Chélidoine", "jour du Traineau"]
let nomJourRevolutionnaireMois6: [String] = ["jour du Tussilage", "jour du Cornouiller", "jour du Violier", "jour du Troene", "jour du Bouc", "jour de l'Asaret", "jour de l'Alaterne", "jour de la Violette", "jour du Marceau", "jour de la Bêche", "jour du Narcisse", "jour de l'Orme", "jour du Fumeterre", "jour du Vélar", "jour de la Chèvre", "jour des Epinards", "jour du Doronic", "jour du Mouron", "jour du Cerfeuil", "jour du Cordeau", "jour de la  Mandragore", "jour du Persil", "jour de la Cochiéaria", "jour de la Pâquerette", "jour du Thon", "jour du Pissenlit", "jour de la Sylve", "jour de la Capillaire", "jour du Frêne", "jour du Plantoir"]

let nomJourRevolutionnaireMois7: [String] = ["jour de la Primevère", "jour du Platane", "jour de l'Asperge", "jour de la Tulipe", "jour de la Poule", "jour de la Bette", "jour du Bouleau", "jour de la Jonquille", "jour de l'Aulne", "jour du Couvoir", "jour de la Pervenche", "jour du Charme", "jour de la Morille", "jour du Hêtre", "jour de l'Abeille", "jour de la Laitue", "jour du Mélèze", "jour de la Ciguë", "jour du Radis", "jour de la Ruche", "jour du Gainier", "jour de la Romaine", "jour du Maronnier", "jour de la Roquette", "jour du Pigeon", "jour du Lilas", "jour de l'Anémone", "jour de la Pensée", "jour de la Myrtille", "jour du Greffoir"]
let nomJourRevolutionnaireMois8: [String] = ["jour de la Rose", "jour du Chêne", "jour de la Fougère", "jour de l'Aubépine", "jour du Rossignol", "jour de l'Ancolie", "jour du Muguet", "jour du Champignon", "jour de la Hyacinthe", "jour du Rateau", "jour de la Rhubarbe", "jour du Sainfoin", "jour du Bâton-d'or", "jour du Chamérisier", "jour du Ver à soie", "jour de la Consoude", "jour de la Pimprenelle", "jour de la Corbeille d'or", "jour de l'Arroche", "jour du Sarcloir", "jour du Staticé", "jour de la Fritillaire", "jour de la Bourache", "jour de la Valériane", "jour de la Carpe", "jour du Fusain", "jour de la Civette", "jour du Buglosse", "jour du Sénevé", "jour de la Houlette"]
let nomJourRevolutionnaireMois9: [String] = ["jour de la Luzerne", "jour de l'Hémérocalle", "jour du Trèfle", "jour de l'Angélique", "jour du Canard", "jour de la Mélisse", "jour du Fromental", "jour du Martagon", "jour du Serpolet", "jour de la FAUX", "jour de la Fraise", "jour de la Bétoine", "jour du Pois", "jour de l'Acacia", "jour de la Caille", "jour de l'Oeillet", "jour du Sureau", "jour du Pavot", "jour du Tilleul", "jour de la Fourche", "jour du Barbeau", "jour de la Camomille", "jour du Chèvre-feuille", "jour du Caille-lait", "jour de la Tanche", "jour du Jasmin", "jour de la Verveine", "jour du Thym", "jour du Pivoine", "jour du Chariot"]

let nomJourRevolutionnaireMois10: [String] = ["jour du Seigle", "jour de l'Avoine", "jour de l'Oignon", "jour de la Véronique", "jour du Mulet", "jour du Romarin", "jour du Concombre", "jour de l'Échalotte", "jour de l'Absinthe", "jour de la Faucille", "jour de la Coriandre", "jour de l'Artichaut", "jour du Giroflet", "jour de la Lavande", "jour du Chamois", "jour du Tabac", "jour de la Groseille", "jour de la Gesse", "jour de la Cerise", "jour du Parc", "jour de la Menthe", "jour du Cumin", "jour du Haricot", "jour de l'Orcanète", "jour de la Pintade", "jour du Sauge", "jour de l'Ail", "jour de la Vesce", "jour du Blé", "jour de la Chalémie"]
let nomJourRevolutionnaireMois11: [String] = ["jour de l'Épeautre", "jour du Bouillon-blanc", "jour du Melon", "jour de l'Ivraie", "jour du Bélier", "jour de la Prêle", "jour de l'Armoise", "jour de la Carthame", "jour de la Mûre", "jour de l'Arrosoir", "jour du Panis", "jour du Salicorne", "jour de l'Abricot", "jour du Basilic", "jour de la Brebis", "jour de la Guimauve", "jour du Lin", "jour de l'Amande", "jour de la Gentiane", "jour de l'Écluse", "jour de la Carline", "jour du Caprier", "jour de la Lentille", "jour de l'Aunée", "jour de la Loutre", "jour de la Myrte", "jour du Colza", "jour du Lupin", "jour du Coton", "jour du Moulin"]
let nomJourRevolutionnaireMois12: [String] = ["jour de la Prune", "jour du Millet", "jour du Lycoperdon", "jour de l'Escourgeon", "jour du Saumon", "jour de la Tubéreuse", "jour du Sucrion", "jour de l'Apocyn", "jour de la Réglisse", "jour de l'Echelle", "jour de la Pastèque", "jour du Fenouil", "jour de l'Épine vinette", "jour de la Noix", "jour de la Truite", "jour du Citron", "jour de la Cardère", "jour du Nerprun", "jour de la Tagette", "jour de la Hotte", "jour de l'Eglantier", "jour de la Noisette", "jour du Houblon", "jour du Sorgho", "jour de l'Écrevisse", "jour de la Bigarade", "jour de la Verge d'or", "jour du Maïs", "jour du Marron", "jour du Panier"]

let nomJourRevolutionnaireMois13: [String] = ["de la Vertu", "du Génie", "du Travail", "de l'Opinion", "des Récompenses", "de la Révolution"]







// de 1789 à 2116

let equiTab: [Double] = [2374743.5 ,2375108.5 ,2375474.5 ,2375839.5 ,2376204.5 ,2376569.5 ,2376935.5 ,2377300.5 ,2377665.5 ,2378030.5 ,2378396.5 ,2378761.5 ,2379126.5 ,2379491.5 ,2379857.5 ,2380222.5 ,2380587.5 ,2380952.5 ,2381318.5 ,2381683.5 ,2382048.5 ,2382413.5 ,2382778.5 ,2383144.5 ,2383509.5 ,2383874.5 ,2384239.5 ,2384605.5 ,2384970.5 ,2385335.5 ,2385700.5 ,2386066.5 ,2386431.5 ,2386796.5 ,2387161.5 ,2387527.5 ,2387892.5 ,2388257.5 ,2388622.5 ,2388988.5 ,2389353.5 ,2389718.5 ,2390083.5 ,2390449.5 ,2390814.5 ,2391179.5 ,2391544.5 ,2391910.5 ,2392275.5 ,2392640.5 ,2393005.5 ,2393371.5 ,2393736.5 ,2394101.5 ,2394466.5 ,2394831.5 ,2395197.5 ,2395562.5 ,2395927.5 ,2396292.5 ,2396658.5 ,2397023.5 ,2397388.5 ,2397753.5 ,2398119.5 ,2398484.5 ,2398849.5 ,2399214.5 ,2399580.5 ,2399945.5 ,2400310.5 ,2400675.5 ,2401041.5 ,2401406.5 ,2401771.5 ,2402136.5 ,2402502.5 ,2402867.5 ,2403232.5 ,2403597.5 ,2403963.5 ,2404328.5 ,2404693.5 ,2405058.5 ,2405423.5 ,2405789.5 ,2406154.5 ,2406519.5 ,2406884.5 ,2407250.5 ,2407615.5 ,2407980.5 ,2408345.5 ,2408711.5 ,2409076.5 ,2409441.5 ,2409806.5 ,2410172.5 ,2410537.5 ,2410902.5 ,2411267.5 ,2411633.5 ,2411998.5 ,2412363.5 ,2412728.5 ,2413094.5 ,2413459.5 ,2413824.5 ,2414189.5 ,2414555.5 ,2414920.5 ,2415285.5 ,2415650.5 ,2416016.5 ,2416381.5 ,2416746.5 ,2417111.5 ,2417476.5 ,2417842.5 ,2418207.5 ,2418572.5 ,2418937.5 ,2419303.5 ,2419668.5 ,2420033.5 ,2420398.5 ,2420764.5 ,2421129.5 ,2421494.5 ,2421859.5 ,2422225.5 ,2422590.5 ,2422955.5 ,2423320.5 ,2423686.5 ,2424051.5 ,2424416.5 ,2424781.5 ,2425147.5 ,2425512.5 ,2425877.5 ,2426242.5 ,2426608.5 ,2426973.5 ,2427338.5 ,2427703.5 ,2428068.5 ,2428434.5 ,2428799.5 ,2429164.5 ,2429529.5 ,2429895.5 ,2430260.5 ,2430625.5 ,2430990.5 ,2431356.5 ,2431721.5 ,2432086.5 ,2432451.5 ,2432817.5 ,2433182.5 ,2433547.5 ,2433912.5 ,2434278.5 ,2434643.5 ,2435008.5 ,2435373.5 ,2435739.5 ,2436104.5 ,2436469.5 ,2436834.5 ,2437200.5 ,2437565.5 ,2437930.5 ,2438295.5 ,2438661.5 ,2439026.5 ,2439391.5 ,2439756.5 ,2440121.5 ,2440487.5 ,2440852.5 ,2441217.5 ,2441582.5 ,2441948.5 ,2442313.5 ,2442678.5 ,2443043.5 ,2443409.5 ,2443774.5 ,2444139.5 ,2444504.5 ,2444870.5 ,2445235.5 ,2445600.5 ,2445965.5 ,2446331.5 ,2446696.5 ,2447061.5 ,2447426.5 ,2447792.5 ,2448157.5 ,2448522.5 ,2448887.5 ,2449253.5 ,2449618.5 ,2449983.5 ,2450348.5 ,2450714.5 ,2451079.5 ,2451444.5 ,2451809.5 ,2452174.5 ,2452540.5 ,2452905.5 ,2453270.5 ,2453635.5 ,2454001.5 ,2454366.5 ,2454731.5 ,2455096.5 ,2455462.5 ,2455827.5 ,2456192.5 ,2456557.5 ,2456923.5 ,2457288.5 ,2457653.5 ,2458018.5 ,2458384.5 ,2458749.5 ,2459114.5 ,2459479.5 ,2459845.5 ,2460210.5 ,2460575.5 ,2460940.5 ,2461306.5 ,2461671.5 ,2462036.5 ,2462401.5 ,2462766.5 ,2463132.5 ,2463497.5 ,2463862.5 ,2464227.5 ,2464593.5 ,2464958.5 ,2465323.5 ,2465688.5 ,2466054.5 ,2466419.5 ,2466784.5 ,2467149.5 ,2467515.5 ,2467880.5 ,2468245.5 ,2468610.5 ,2468976.5 ,2469341.5 ,2469706.5 ,2470071.5 ,2470437.5 ,2470802.5 ,2471167.5 ,2471532.5 ,2471898.5 ,2472263.5 ,2472628.5 ,2472993.5 ,2473359.5 ,2473724.5 ,2474089.5 ,2474454.5 ,2474819.5 ,2475185.5 ,2475550.5 ,2475915.5 ,2476280.5 ,2476646.5 ,2477011.5 ,2477376.5 ,2477741.5 ,2478107.5 ,2478472.5 ,2478837.5 ,2479202.5 ,2479568.5 ,2479933.5 ,2480298.5 ,2480663.5 ,2481029.5 ,2481394.5 ,2481759.5 ,2482124.5 ,2482490.5 ,2482855.5 ,2483220.5 ,2483585.5 ,2483951.5 ,2484316.5 ,2484681.5 ,2485046.5 ,2485411.5 ,2485777.5 ,2486142.5 ,2486507.5 ,2486872.5 ,2487238.5 ,2487603.5 ,2487968.5 ,2488333.5 ,2488699.5 ,2489064.5 ,2489429.5 ,2489794.5 ,2490160.5 ,2490525.5 ,2490890.5 ,2491255.5 ,2491621.5 ,2491986.5 ,2492351.5 ,2492716.5 ,2493082.5 ,2493447.5 ,2493812.5 ,2494177.5]

equiTab.count

// 1789+328



let moisRevolutionaire: [String] = ["", "Vendémiaire" ,"Brumaire" ,"Frimaire" ,"Nivôse" ,"Pluviôse" ,"Ventôse" ,"Germinal" ,"Floréal" ,"Prairial" ,"Messidor" ,"Thermidor" ,"Fructidor" ,"Sans-culottides" ]

let moisGregorien: [String] = ["", "janvier","février","mars","avril","mai","juin","juillet","aoüt","septembre","octobre","novembre","décembre"]

let sansCulottides: [String] = ["", "de la vertu", "du génie", "du travail", "de l'opinion", "des récompenses", "de la révolution"]


var jd : [Double] = [2457480.5,2376512.5,2378443.5,2379852.5,2376934.5,2446051.5,2445398.5,2436707.5,2436579.5]
var nomjour: [String] = ["Samedi","Dimanche", "Samedi",   "Lundi",    "Mardi",    "Lundi",    "Samedi",   "Mardi",    "Dimanche"]
var jour: [Int] = [2,  27, 9,  19, 22, 17, 5,  19, 11]
var mois: [Int] = [4, 7, 11, 9, 9, 12, 3, 5, 1]
var annee: [Int] = [2016, 1794, 1799, 1803, 1795, 1984, 1983, 1959, 1959]


let GREGORIAN_EPOCH = 1721425.5
let FRENCH_REVOLUTIONARY_EPOCH = 2375839.5
let TropicalYear: Double = 365.24219878;           // Mean solar tropical year

func leap_gregorian(year: Int) -> Bool
{
    return ((year % 4) == 0) && (!(((year % 100) == 0) && ((year % 400) != 0)))
}


func mod(a: Int, b: Int) -> Int
{
    return a % b
}

func gregorian_to_jd(year: Int, month: Int, day: Int) -> Double
{
    var temp: Int = 365 * (year - 1)
    temp += (year - 1) / 4
    temp -= (year - 1) / 100
    temp += (year - 1) / 400
    temp += ((367 * month) - 362) / 12
    temp += (month <= 2) ? 0 : (leap_gregorian(year: year) ? -1 : -2)
    temp += day
    return (GREGORIAN_EPOCH - 1) + Double(temp)
}

// gregorian_to_jd(2016, month: 4, day: 3)

func jd_to_gregorian(jd: Double) -> [Int]
{
    let wjd : Double = floor(jd - 0.5) + 0.5
    let depoch: Int = Int(wjd - GREGORIAN_EPOCH)
    let quadricent: Int = depoch / 146097
    let dqc: Int = mod(a: depoch, b: 146097)
    let cent: Int = dqc / 36524
    let dcent: Int = mod(a: dqc, b: 36524)
    let quad: Int = dcent / 1461
    let dquad: Int = mod(a: dcent, b: 1461)
    let yindex: Int  = dquad / 365
    var year: Int = (quadricent * 400) + (cent * 100) + (quad * 4) + yindex
    
    if (!((cent == 4) || (yindex == 4))) {
        year += 1
    }
    
    let yearday: Int = Int(wjd - gregorian_to_jd(year: year, month: 1, day: 1))
    let leapadj: Int = ((wjd < gregorian_to_jd(year: year, month: 3, day: 1)) ? 0 : (leap_gregorian(year: year) ? 1 : 2))
    let month = (((yearday + leapadj) * 12) + 373) / 367
    let day: Int = Int((wjd - gregorian_to_jd(year: year, month: month, day: 1))) + 1
    return [year, month, day]
}

// jd_to_gregorian(2457481.5) // vérifié
// jd_to_gregorian(2376512.5) // vérifié
// jd_to_gregorian(2379852.5) // vérifié

func paris_equinoxe_jd(year: Int) -> Double
{
    return equiTab[year - 1789]
}


func annee_de_la_revolution(jd: Double) -> (an: Int, julian: Double)
{
    var guess: Int = jd_to_gregorian(jd: jd)[0] - 2
    

    var lasteq: Double = paris_equinoxe_jd(year: guess)
    
    while (lasteq > jd) {
        guess -= 1
        lasteq = paris_equinoxe_jd(year: guess)
    }
    
    var nexteq: Double = lasteq - 1
    while (!((lasteq <= jd) && (jd < nexteq))) {
        lasteq = nexteq
        guess += 1
        nexteq = paris_equinoxe_jd(year: guess)
    }
    
    let adr = Int(round((lasteq - FRENCH_REVOLUTIONARY_EPOCH) / TropicalYear) + 1)
    
    return (adr, lasteq)
}

// annee_de_la_revolution(2457481.5) // vérifié
// annee_de_la_revolution(2376512.5) // vérifié
// annee_de_la_revolution(2376934.5) // vérifié


func french_revolutionary_to_jd(an: Int, mois: Int, decade: Int, jour: Int) -> Double
{
    // var adr, equinoxe, guess, jd
    
    var guess: Double = FRENCH_REVOLUTIONARY_EPOCH + (TropicalYear * Double(((an - 1) - 1)))
    
    var adr: (an: Int, julian: Double) = (an - 1, 0.0)
    
    while (adr.an < an) {
        adr = annee_de_la_revolution(jd: guess)
        guess = adr.julian + (TropicalYear + 2);
    }
    
    let  equinoxe = adr.julian
    
    var temp = 30 * (mois - 1)
    temp += 10 * (decade - 1)
    
    return equinoxe + Double(temp + jour - 1)
}

// french_revolutionary_to_jd(2, mois: 11, decade: 1, jour: 9) // vérifié
// french_revolutionary_to_jd(8, mois: 2, decade: 2, jour: 8) // vérifié
// french_revolutionary_to_jd(11, mois: 13, decade: 1, jour: 2) // vérifié


func jd_to_french_revolutionary(jd: Double) -> (an: Int, mois: Int, decade: Int, jour:Int, jourm: Int)
{
    let adr = annee_de_la_revolution(jd: jd)
    let an: Int = adr.an
    let equinoxe:Double = adr.julian
    
    let mois: Int = Int(floor((jd - equinoxe) / 30)) + 1
    
    var jour:Int = Int((jd - equinoxe)) % 30
    
    let decade:Int = Int(floor(Double(jour) / 10)) + 1
    
    let jourm = jour + 1
    
    jour = (jour % 10) + 1
    
    return (an, mois, decade, jour, jourm)
    
}

// conversion directe de la date grégorienne en date révolutionnaire

func g2f(year: Int, month: Int, day: Int) -> (an: Int, mois: Int, decade: Int, jour:Int, jourm: Int) {
    
    let jd = gregorian_to_jd(year: year, month: month, day: day)
    return jd_to_french_revolutionary(jd: jd)
}

// g2f(1812, month: 9, day: 22)

func printg2f(year: Int, month: Int, day: Int) -> String {
    let (an, mois, _, jour, jourm) = g2f(year: year, month: month, day: day)
    let s: String = (mois == 13) ? "jour \(sansCulottides[jour])" : "\(jourm)  \(moisRevolutionaire[mois])"
    return "\(day) \(moisGregorien[month]) \(year) -> \(s) an \(an)"
}



func leapRevolutionary(an: Int) -> Bool {
    // est bissextile si la veille du 1er vendémiaire de l'année suivante
    // est le jour de la révolution, soit 6
    
    let jd1erVendemiaire = french_revolutionary_to_jd(an: an + 1, mois: 1, decade: 1, jour: 1)
    
    let jdAvant = jd1erVendemiaire - 1
    
    let (_, mois, _, jour, _) = jd_to_french_revolutionary(jd: jdAvant)
    
    return (mois == 13 && jour == 6)
}


let JDdimanche3avril2016 = gregorian_to_jd(year: 2016, month: 4, day: 3)
let JRdimanche3avril2016 = jd_to_french_revolutionary(jd: JDdimanche3avril2016)
var jr = JRdimanche3avril2016
print("\(jr.jourm) \(moisRevolutionaire[jr.mois]) an \(jr.an)")

let JD27juillet1794 = gregorian_to_jd(year: 1794, month: 7, day: 27)
let JR27juillet1794 = jd_to_french_revolutionary(jd: JD27juillet1794)
jr = JR27juillet1794
print("\(jr.jourm) \(moisRevolutionaire[jr.mois]) an \(jr.an)")

let JD9novembre1799 = gregorian_to_jd(year: 1799, month: 11, day: 9)
let JR9novembre1799 = jd_to_french_revolutionary(jd: JD9novembre1799)
jr = JR9novembre1799
print("\(jr.jourm) \(moisRevolutionaire[jr.mois]) an \(jr.an)")

printg2f(year: 2016, month: 4, day: 17)
// l'an 20 est bissextile, débute le 23 sept 1811, se termine le 22 sept 1812
printg2f(year: 1811, month: 9, day: 23)
printg2f(year: 1812, month: 9, day: 22)

// bissextile
printg2f(year: 1839, month: 9, day: 23)
g2f(year: 1840, month: 9, day: 22)

// non bissextile
printg2f(year: 1842, month: 9, day: 23)
printg2f(year: 1843, month: 9, day: 22)




//leapRevolutionary(222)  // true
//leapRevolutionary(3)    // true
//leapRevolutionary(7)    // true
//leapRevolutionary(11)   // true
//leapRevolutionary(15)   // true
//leapRevolutionary(323)  // false



var s: String = ""

for var i in 1...2 {
    s += "\(leapRevolutionary(an: i) ? 366 : 365),"
}

print(s)


var today: NSDate = NSDate()
// var firstVendemiaire : NSDate = NSDate(withNaturalLanguageString: "2014-09-12")

let dateString = "1792-09-22"
let dateFormatter = DateFormatter()
dateFormatter.dateFormat = "yyyy-MM-dd"
dateFormatter.locale = Locale.init(identifier: "fr_FR")

var premVen : NSDate?


if let dateObj = dateFormatter.date(from: dateString) {
    dateFormatter.dateFormat = "dd-MM-yyyy"
    print("Dateobj: \(dateFormatter.string(from: dateObj))")
    premVen = dateObj as NSDate
}

let calendar2 = NSCalendar.current

// Replace the hour (time) of both dates with 00:00
let date1 : Date = calendar2.startOfDay(for: today as Date)
let date2 : Date = calendar2.startOfDay(for: premVen as Date)

print(date2)


let components = calendar2.dateComponents([.day], from: date2, to: date1)



let calendar = NSCalendar(identifier: NSCalendar.Identifier.gregorian)!
let components = calendar.components([.month, .day, .year], from: today as Date)
components.day
components.month
components.year

let (_an, _mois, _, _, _jourm) = g2f(year: components.year!, month: components.month!, day: components.day!)
_an
_mois
_jourm


func romanise(year: Int) -> String {
    let tab:[(roman: String, num: Int)] = [("M", 1000),("CM", 900),("D", 500),("CD", 400),("C", 100),("XC", 90),("L", 50),("XL", 40),("X", 10),("IX", 9),("V", 5),("IV", 4),("I", 1)]
    var Roman: String = ""
    var num: Int = year
    
    for (r,n) in tab {
        while num >= n {
            Roman += r
            num -= n
        }
    }
    return Roman
}

// print(romanise(224))
// print(romanise(2016))

//mod(5, b: 4)
//mod(4, b: 5)
//mod(15, b:3)
//mod(3, b: 15)



// moisR = nomJourRevolutionnaireMois5

//moisR[1]
//
//// (an, mois, decade, jour, jourm)
g2f(year: 1794, month: 7, day: 27)
//
//moisR = nomJourRevolutionnaireMois11
//moisR[8]


func nomJourDateR(day: Int, month: Int) -> String {
    var moisR: [String] = [String]()
    var nomJour: String = ""
    
    if month < 13 {
    
    switch month {
    case 1:
        moisR = nomJourRevolutionnaireMois1
    case 2:
        moisR = nomJourRevolutionnaireMois2
    case 3:
        moisR = nomJourRevolutionnaireMois3
    case 4:
        moisR = nomJourRevolutionnaireMois4
    case 5:
        moisR = nomJourRevolutionnaireMois5
    case 6:
        moisR = nomJourRevolutionnaireMois6
    case 7:
        moisR = nomJourRevolutionnaireMois7
    case 8:
        moisR = nomJourRevolutionnaireMois8
    case 9:
        moisR = nomJourRevolutionnaireMois9
    case 10:
        moisR = nomJourRevolutionnaireMois10
    case 11:
        moisR = nomJourRevolutionnaireMois11
    default:
        moisR = nomJourRevolutionnaireMois12
    }
    
        // nomjour = moisR[day - 1]
        nomJour = moisR[day - 1 ]
        
    } else {
        
        // jours complémentaires
        nomJour = "jour \(sansCulottides[day])"
        
        
        
    }
    
    return nomJour
}


nomJourDateR(day: 9, month : 11)
nomJourDateR(day: 6, month : 13)


// convertit une date R en date G
func f2g(an: Int, mois: Int, jourm: Int) -> (year: Int, month: Int, day: Int) {
    
    // calculer la decade
    let decade:Int = Int(floor(Double(jourm) / 10)) + 1
    print("decade \(decade)")
    
    let jour: Int = jourm - (decade - 1) * 10
    
    
    // R vers Julien
    let jd: Double = french_revolutionary_to_jd(an: an, mois: mois, decade: decade, jour: jour)
    
    // Julien vers Grégorien
    var gDateArray: [Int]
    gDateArray = jd_to_gregorian(jd: jd) // [year, month, day]
    
    return(gDateArray[0], gDateArray[1], gDateArray[2])
    
}

f2g(an: 2, mois:11, jourm: 9)



//leapRevolutionary(222)  // true
//leapRevolutionary(3)    // true
//leapRevolutionary(7)    // true
//leapRevolutionary(11)   // true
//leapRevolutionary(15)   // true
//leapRevolutionary(323)  // false

func nbJourRdansMois(mois: Int, an: Int) -> Int {
    if (mois > 12) {
        return 5 + (leapRevolutionary(an: an) ? 1:0)
    }
    
    return 30
}

nbJourRdansMois(mois: 13, an: 7) // 6 ?
nbJourRdansMois(mois: 1, an: 7)  // 30 ?
nbJourRdansMois(mois: 13, an: 16)  // 5 ?
nbJourRdansMois(mois: 13, an: 224)  // 5 ?
nbJourRdansMois(mois: 13, an: 222)  // 6 ?

class JourDeMois {
    func makeValues(mois: Int, an: Int) -> [Int] {
        
        let n = nbJourRdansMois(mois: mois, an: an)
        switch n {
        case 5:
            return [1,2,3,4,5]
        case 6:
            return [1,2,3,4,5,6]
        default:
            return [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]
        }
    }
}

let o = JourDeMois()

o.makeValues(mois: 13, an: 7)


























































































